!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t){t.exports={layout:{canvas:{size:600,offsetTop:0,offsetLeft:0},main:{width:600,height:480,offsetTop:0,offsetLeft:0},navigation:{width:600,height:80,offsetTop:520,offsetLeft:0},tooltip:{width:120,height:70,offsetTop:1,offsetLeft:0}},colors:{shadow:"#e9e8e8",greyLine:"#d0d0d0",greyText:"#8c8c8c",navigationCover:"rgba(234,255,221,0.5)",navigationHandler:"rgba(234,255,221,1)"},fonts:{regular:{fontFamily:"Arial",fontSize:"12px"},highlight:{fontSize:"16px"}}}},,,function(t,e,i){"use strict";i.r(e);var s=i(0);var o=class{constructor(t){this.data=t,this.animationTime=5,this.targetY=[],this.targetVisibility=!0,this.opacity=1}draw(t){this._needMoveAnimation()&&this._animateMovement(),this._needFadeAnimation()&&this._animateFade(),this._drawLine(t)}updatePositions(t,e){this.data.positionsX=t.slice(0),this.targetY=e.slice(0)}updateVisibility(t){this.targetVisibility=t}_animateMovement(){let t=!1;this.data.positionsY=this.data.positionsY.map((e,i)=>{const s=this.targetY[i]-e;return 0!==s&&(t=!0,e=this._recalculatePosition(e,s)),e}),t||(this.targetY=[])}_animateFade(){this.targetVisibility?this.opacity+=.1:this.opacity-=.1,this.opacity=Math.min(this.opacity,1),this.opacity=Math.max(this.opacity,0),this.opacity.between(0,1)||(this.data.visible=this.targetVisibility)}_recalculatePosition(t,e){let i=e/this.animationTime;return e>0?i=Math.min(Math.ceil(i),e):e<0&&(i=Math.max(Math.floor(i),e)),t+=i}_needMoveAnimation(){return this.targetY.length}_needFadeAnimation(){return this.data.visible!==this.targetVisibility}_drawLine(t){t.save(),t.lineWidth=2,t.strokeStyle=this.data.color,t.globalAlpha=this.opacity,t.beginPath();const e=this.data.positionsX[0],i=this.data.positionsY[0];t.moveTo(e,i);for(let e=1;e<this.data.valuesCount;e++){const i=this.data.positionsX[e],s=this.data.positionsY[e];t.lineTo(i,s)}t.stroke(),t.restore()}};var a=class{constructor(t){this.data=t,this.hoverX=null,this.hoverY=null}setHoverPosition(t,e){this.hoverX=t||null,this.hoverY=e||null}updateVisibility(t){this.data.visible=t}draw(t){this.hoverX>0&&this.hoverY>0&&this.data.visible&&(t.save(),t.strokeStyle=this.data.color,t.fillStyle="#ffffff",t.lineWidth=4,t.beginPath(),t.arc(this.hoverX,this.hoverY,5,0,2*Math.PI),t.stroke(),t.fill(),t.restore())}},n=class{static aliasPixel(t){return t%2==0?0:.5}static sortNumbersAsc(t){return t.slice(0).sort((t,e)=>t-e)}static sortNumbersDesc(t){return t.slice(0).sort((t,e)=>e-t)}static getMinMax(t){return[(t=this.sortNumbersAsc(t))[0],t[t.length-1]]}static isMouseInsideLayout(t,e,i){const{width:s,height:o,offsetTop:a,offsetLeft:n}=i;return t.between(n,n+s)&&e.between(a,a+o)}static formatMonth(t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t]}static formatWeekday(t){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t]}static arrayUnique(t){const e=t.concat();for(let t=0;t<e.length;t++)for(let i=t+1;i<e.length;i++)e[t]===e[i]&&e.splice(i--,1);return e}static formatNumber(t){const e=Math.log(t)/Math.log(1e3)|0;return+(t/Math.pow(1e3,e)).toFixed(2)+("kMGTPEZY"[e-1]||"")}};var r=class{constructor(t,e,i,s,o){this.minSpaceBetweenGridLineX=80,this.layout=o,this.positionsX=t,this.captionsX=e,this.positionsY=i,this.captionsY=s,this.minX=this.layout.offsetLeft+10,this.maxX=this.layout.offsetLeft+this.layout.width-10,this.minY=this.layout.offsetTop+this.layout.height,this.maxY=this.layout.offsetTop,this.xAxisCaptionPositionY=this.minY+20,this.opacititesX=this.calcOpacitiesX(),this.animationTime=5,this.hoverPositionX=null,this.targetPositionsY=[],this.targetOpacititesX=[]}calcOpacitiesX(){let t=Math.ceil(this.minSpaceBetweenGridLineX/(this.positionsX[1]-this.positionsX[0]));t=[1,2,4,8,16,32,64,128,256,512].findClosestValue(t);const e=Array(this.positionsX.length).fill(0);for(let i=0;i<=this.positionsX.length;i+=t)e[i]=1;return e}updatePositions(t,e,i){this.positionsX=t.slice(0),this.targetPositionsY=e.slice(0),this.targetOpacititesX=this.calcOpacitiesX();const s=i.slice(0),o=e.slice(0);let a=[];const[r,h]=n.getMinMax(s);this.captionsY.forEach(t=>{t>h?(s.push(t),o.push(-100)):t<r&&(s.unshift(t),o.unshift(this.layout.height+100))}),s.forEach(t=>{const e=this.captionsY.indexOf(t);let i;e>=0&&(i=this.positionsY[e]),a.push(i)});const l=Math.round(this.positionsY[1]-this.positionsY[0])/2;a=(a=a.map((t,e)=>{if(!t){const i=a[e-1];t=l+i}return t})).map((t,e)=>t||o[e]),this.positionsY=a,this.captionsY=s,this.targetPositionsY=o}setHoverPositionX(t){this.hoverPositionX=t}draw(t){this._needAnimationX()&&this._animateX(),this._needAnimationY()&&this._animateY(),this._drawGridY(t),this._drawBottomSquare(t),this._drawGridX(t,!0),null!==this.hoverPositionX&&this._drawVerticalGridLine(t,this.hoverPositionX)}_animateX(){let t=!1;this.opacititesX=this.opacititesX.map((e,i)=>{const s=this.targetOpacititesX[i]-e;let o=s/this.animationTime;return 0!==s&&(t=!0,s>0?o=Math.min(o,s):s<0&&(o=Math.max(o,s)),e+=o),e}),t||(this.targetOpacititesX=[])}_animateY(){let t=!1;this.positionsY=this.positionsY.map((e,i)=>{const s=this.targetPositionsY[i]-e;let o=s/this.animationTime;return 0!==s&&(t=!0,s>0?o=Math.min(Math.ceil(o),s):s<0&&(o=Math.max(Math.floor(o),s)),e+=o),e}),t||(this.targetPositionsY=[])}_needAnimationX(){return this.targetOpacititesX.length}_needAnimationY(){return this.targetPositionsY.length}_drawGridX(t,e=!1){for(let i=0;i<=this.positionsX.length;i++){const s=this.positionsX[i],o=this.captionsX[i],a=this.opacititesX[i];e||this._drawVerticalGridLine(t,s),this._drawGridText(t,o,s,this.xAxisCaptionPositionY,"center",a)}}_drawGridY(t){for(let e=0;e<=this.positionsY.length;e++){const i=this.positionsY[e],s=this.captionsY[e];this._drawHorizontalGridLine(t,i),this._drawGridText(t,s,this.minX,i-10,"left")}}_drawHorizontalGridLine(t,e){t.save(),t.fillStyle=s.colors.greyLine,t.fillRect(this.minX,e-1,this.maxX,1),t.restore()}_drawVerticalGridLine(t,e){t.save(),t.fillStyle=s.colors.greyLine,t.fillRect(e,this.maxY,1,this.minY),t.restore()}_drawGridText(t,e,i,o,a,n=1){t.save(),t.fillStyle=s.colors.greyText,t.font=s.fonts.regular.fontSize+" "+s.fonts.regular.fontFamily,t.globalAlpha=n,t.lineWidth=1,t.textAlign=a,t.fillText(e,i,o),t.restore()}_drawBottomSquare(t){t.save(),t.fillStyle="white",t.fillRect(s.layout.main.offsetLeft,s.layout.main.offsetTop+s.layout.main.height,s.layout.main.width,t.canvas.offsetHeight-s.layout.main.height),t.restore()}};var h=class{constructor(t,e,i){this.layout=i;const[s,o]=n.getMinMax(t),[a,r]=n.getMinMax(e);this.stepY=this._calculateAxisYStep(a,r),this.valuesX=t,this.valuesY=e,this.minX=s,this.maxX=o,this.minY=this._calculateMinY(a),this.maxY=this._calculateMaxY(r),this.deltaX=this.maxX-this.minX,this.deltaY=this.maxY-this.minY,this.scaleX=1,this.scaleY=1,this.offsetX=0,this.translateX=0,this.translateY=0,this.yAxisMinLinesCount=4,this.yAxisMaxLinesCount=7}setVisibleRange(t){const[e,i]=t,s=i-e;this.scaleX=1/s,this.offsetX=e,this.translateX=e*this.layout.width*this.scaleX}setMinMaxY(t,e){this.stepY=this._calculateAxisYStep(t,e),this.minY=this._calculateMinY(t),this.maxY=this._calculateMaxY(e),this.deltaY=this.maxY-this.minY}coordsToPxPosition(t,e){return[this.xCoordToXPxPosition(t),this.yCoordToYPxPosition(e)]}xCoordToXPxPosition(t){return this._coordToPxPosition(t,this.minX,this.deltaX,this.layout.width,this.layout.offsetLeft-this.translateX,this.scaleX)}yCoordToYPxPosition(t){return t=this.maxY-t+this.minY,this._coordToPxPosition(t,this.minY,this.deltaY,this.layout.height,this.layout.offsetTop-this.translateY,this.scaleY)}pxPositionXToValueX(t){const e=this._pxPositionToCoord(t,this.minX,this.deltaX,this.layout.width,this.offsetX,this.scaleX);return this.valuesX.findClosestValue(e)}_calculateAxisYStep(t,e){const i=e-t;let s=Math.pow(10,i.toString().length-1);const o=i/s;return o.between(this.yAxisMinLinesCount,this.yAxisMaxLinesCount,!0)||(o<this.yAxisMinLinesCount?s/=2:o>this.yAxisMaxLinesCount&&(s*=2)),s}_calculateMinY(t){return Math.floor(t/this.stepY)*this.stepY}_calculateMaxY(t){return Math.ceil(t/this.stepY)*this.stepY}_coordToPxPosition(t,e,i,s,o,a){const n=(t-e)/i;let r=Math.round(n*s);return r*=a,r+=o}_pxPositionToCoord(t,e,i,s,o,a){let n=t/s;return n/=a,n+=o,Math.round(n*i)+e}};var l=class{constructor(t){this.chartsData=t,this.converter=null,this.visibleRange=[0,1],this.visibleCharts=[]}setLayout(t){this.converter=new h(this.getAllValuesX(),this.getAllValuesY(),t)}setVisibleRange(t){this.visibleRange=t,this.converter.setVisibleRange(t),this.converter.setMinMaxY(...this.getMinMaxVisibleValueY())}getNormalizedChartsData(){const t=[];for(let e=0;e<this.getChartsAmount();e++)t.push(this.prepareChartData(e));return t}getBaseName(){return"Chart "+(this.chartsData.index+1)}getNames(){const t=[];return this.chartsData.columns.forEach(e=>{const i=e[0];this.chartsData.names[i]&&t.push(this.chartsData.names[i])}),t}getColors(){const t=[];return this.chartsData.columns.forEach(e=>{const i=e[0];this.chartsData.colors[i]&&t.push(this.chartsData.colors[i])}),t}getAllValuesX(){return this.getValuesInColumn(this.chartsData.types.x)}getAllValuesY(){const t=this.chartsData.columns.filter(t=>t[0]!==this.chartsData.types.x);let e=[];return t.forEach(t=>e=e.concat(t.slice(1))),e}getMinMaxVisibleValueY(){const[t,e]=this.visibleRange;let i=null,s=null;return this.getNormalizedChartsData().filter(t=>t.visible).forEach(o=>{const a=Math.floor(o.valuesY.length*t),r=Math.ceil(o.valuesY.length*e),h=o.valuesY.slice(a,r),[l,c]=n.getMinMax(h);i=i?Math.min(i,l):l,s=s?Math.max(s,c):c}),[i,s]}getPositionsOnAxisX(){return this.getAllValuesX().map(t=>this.converter.xCoordToXPxPosition(t))}getPositionsOnAxisY(){return this.getCaptionsOnAxisY().map(t=>this.converter.yCoordToYPxPosition(t))}getCaptionsOnAxisX(){return this.getAllValuesX().map(t=>{const e=new Date(t);return n.formatMonth(e.getMonth())+" "+e.getDate()})}getCaptionsOnAxisY(){const t=[];for(let e=this.converter.minY;e<this.converter.maxY;e+=this.converter.stepY)t.push(e);return t}getValuesInColumn(t){return this.chartsData.columns.filter(e=>t===e[0])[0].slice(1)}getChartsAmount(){return this.chartsData.columns.length-1}prepareChartData(t){const e=`y${t}`,i=this.getAllValuesX(),s=this.getValuesInColumn(e),o=i.length,[a,n]=this.calculatePositions(i,s,o);return{index:t,visible:this.visibleCharts.indexOf(t)<0,type:this.chartsData.types[e],color:this.chartsData.colors[e],name:this.chartsData.names[e],valuesCount:o,valuesX:i,valuesY:s,positionsX:a,positionsY:n}}calculatePositions(t,e,i){const s=[],o=[];for(let a=0;a<i;a++){const i=t[a],n=e[a],[r,h]=this.converter.coordsToPxPosition(i,n);s.push(r),o.push(h)}return[s,o]}getHoverPosition(t,e){let i=null;if(n.isMouseInsideLayout(t,e,this.converter.layout)){const e=this.converter.pxPositionXToValueX(t);i=this.converter.valuesX.indexOf(e)}return i}toggleChart(t){this.visibleCharts[t]=this.visibleCharts.indexOf(t)<0?t:null,this.converter.setMinMaxY(...this.getMinMaxVisibleValueY())}};var c=class{constructor(){this.layout=s.layout.tooltip,this.halfWidth=this.layout.width/2,this.hoverX={position:null,caption:null}}setCharts(t){this.charts=t}setHoverX(t,e){this.hoverX={position:t,caption:e}}draw(t){if(null!==this.hoverX.position){const e=this.hoverX.position-this.halfWidth;this._drawRect(t,e),this._drawText(t,e+10,this.hoverX.caption)}}_drawRect(t,e){const{width:i,height:o,offsetTop:a}=this.layout;t.save(),t.strokeStyle=s.colors.greyLine,t.fillStyle="white",t.shadowColor=s.colors.shadow,t.shadowOffsetY=1,t.shadowBlur=1,t.beginPath(),t.rect(e,a,i,o),t.stroke(),t.fill(),t.restore()}_drawText(t,e,i){const{offsetTop:s}=this.layout;let o=s+20;this._drawDate(t,e,o,i),o+=25;let a=0;this.charts.forEach(i=>{this._drawValue(t,e+a,o,i.hoverValueY,i.data.color),this._drawChartName(t,e+a,o+15,i.data.name,i.data.color),a+=this.halfWidth})}_drawDate(t,e,i,o){t.save(),t.font=s.fonts.highlight.fontSize+" "+s.fonts.regular.fontFamily,t.fillText(o,e,i),t.restore()}_drawValue(t,e,i,o,a){t.save(),t.fillStyle=a,t.font="bold "+s.fonts.highlight.fontSize+" "+s.fonts.regular.fontFamily,t.fillText(o,e,i),t.restore()}_drawChartName(t,e,i,o,a){t.save(),t.fillStyle=a,t.font=s.fonts.regular.fontSize+" "+s.fonts.regular.fontFamily,t.fillText(o,e,i),t.restore()}};var u=class{constructor(t){const e=t.getBoundingClientRect();this.canvas=t,this.offsetTop=e.top,this.offsetLeft=e.left,this.dataManager=null,this.hasHover=!1,this.charts=[],this.grid=null,this.tooltip=null}setChartsData(t){return this.dataManager=new l(t),this}setLayout(t){return this.dataManager.setLayout(t),this}setVisibleRange(t){return this.dataManager.setVisibleRange(t),this.updateCharts(),this.grid&&this.updateGrid(),this}enableHover(){return this.hasHover=!0,this._bindHoverEvents(),this}createCharts(){return this.dataManager.getNormalizedChartsData().forEach(t=>{switch(t.type){case"line":const e=new o(t);this.charts.push(e);break;default:console.error(`unsupported chart type ${type}`)}}),this.hasHover&&this._createChartsHover(),this.charts}updateCharts(){const t=this.dataManager.getNormalizedChartsData();this.charts.filter(t=>"function"==typeof t.updatePositions).forEach(e=>{const i=e.data,{positionsX:s,positionsY:o}=t[i.index];e.updatePositions(s,o)}),this.charts.forEach(e=>{const i=e.data,{visible:s}=t[i.index];e.updateVisibility(s)})}updateGrid(){this.grid.updatePositions(this.dataManager.getPositionsOnAxisX(),this.dataManager.getPositionsOnAxisY(),this.dataManager.getCaptionsOnAxisY())}createGrid(){return this.grid=new r(this.dataManager.getPositionsOnAxisX(),this.dataManager.getCaptionsOnAxisX(),this.dataManager.getPositionsOnAxisY(),this.dataManager.getCaptionsOnAxisY(),this.dataManager.converter.layout),this.grid}createTooltip(){return this.tooltip=new c(this.charts),this.tooltip}toggleChart(t){this.dataManager.toggleChart(t),this.updateCharts(),this.grid&&this.updateGrid()}_createChartsHover(){this.dataManager.getNormalizedChartsData().forEach(t=>{switch(t.type){case"line":this.charts.push(new a(t))}})}_bindHoverEvents(){this.canvas.addEventListener("mousemove",t=>this._onMouseMove(t)),this.canvas.addEventListener("mouseleave",t=>this._onMouseLeave(t))}_onMouseMove(t){const e=Math.round(t.clientX-this.offsetLeft+window.scrollX),i=Math.round(t.clientY-this.offsetTop+window.scrollY);this._handleMouseMove(e,i)}_onMouseLeave(){this._handleMouseMove(-100,-100)}_handleMouseMove(t,e){const i=this.dataManager.getHoverPosition(t,e),s=this.dataManager.getAllValuesX()[i],a=new Date(s),r=n.formatWeekday(a.getDay())+", "+n.formatMonth(a.getMonth())+" "+a.getDate(),h=this.dataManager.converter.xCoordToXPxPosition(s),l=this.charts.map(t=>(t.hoverValueY=t.data.valuesY[i],t.hoverCoordY=this.dataManager.converter.yCoordToYPxPosition(t.hoverValueY),t));l.filter(t=>"function"==typeof t.setHoverPosition).forEach(t=>t.setHoverPosition(h,t.hoverCoordY)),this.grid&&this.grid.setHoverPositionX(h),this.tooltip&&(this.tooltip.setCharts(l.filter(t=>t instanceof o)),this.tooltip.setHoverX(h,r))}};const d=.25,g=.5,v=[],f=[];function p(t,e,i){v[t]=[e,i],f.forEach(t=>t())}function M(t){return v[t]||function(t){v[t]=[d,g]}(t),v[t]}var m=class{constructor(t,e){const i=M();this.chartsFactory=new u(t.canvas).setChartsData(e).setLayout(s.layout.main).enableHover().setVisibleRange(i),this.ctx=t,this.charts=this.chartsFactory.createCharts(),this.grid=this.chartsFactory.createGrid(),this.tooltip=this.chartsFactory.createTooltip(),this.index=e.index,this._bindEvents()}draw(){this.grid.draw(this.ctx),this.charts.forEach(t=>t.draw(this.ctx)),this.tooltip.draw(this.ctx)}toggleChart(t){this.chartsFactory.toggleChart(t)}_bindEvents(){var t;t=(()=>this.chartsFactory.setVisibleRange(M(this.index))),f.push(t)}},x=class{constructor(t,e){const[i,o]=M();this.ctx=t,this.chartsFactory=new u(this.ctx.canvas).setChartsData(e).setLayout(s.layout.navigation),this.charts=this.chartsFactory.createCharts(),this.rangeFromPx=this._convertRangePercentsToPx(i),this.rangeToPx=this._convertRangePercentsToPx(o),this.prevRangeMoveMouseX=null,this.deltaRangeMoveMouseX=0,this.mouseBorderWidth=40,this.mouseBorderWidthHalf=Math.round(this.mouseBorderWidth/2),this.prevLeftBorderMoveMouseX=null,this.prevRightBorderMoveMouseX=null,this.deltaLeftBorderMoveMouseX=0,this.deltaRightBorderMoveMouseX=0,this.minVisibleRangeDelta=60,this.index=e.index,this.mouseX=null,this.mouseY=null,this.bindEvents()}bindEvents(){this.clickAndMouseMoveHandler=this.onClickAndMouseMove.bind(this),this.ctx.canvas.addEventListener("mousedown",t=>this.onMouseDown(t),!1),this.ctx.canvas.addEventListener("mouseleave",t=>this.onMouseLeave(t),!1),this.ctx.canvas.addEventListener("mousemove",t=>this.onMouseMove(t),!1),document.addEventListener("mouseup",t=>this.onMouseUp(t),!1)}onMouseDown(t){document.addEventListener("mousemove",this.clickAndMouseMoveHandler,!1),this._actualizeMouseLocalPosition(t),this.prevLeftBorderMoveMouseX=this._isMouseOnLeftRangeBorder()?this.mouseX:null,this.prevRightBorderMoveMouseX=this._isMouseOnRightRangeBorder()?this.mouseX:null,this.prevLeftBorderMoveMouseX||this.prevRightBorderMoveMouseX||(this.prevRangeMoveMouseX=this._isMouseOnRange()?this.mouseX:null)}onMouseMove(t){this._actualizeMouseLocalPosition(t),document.body.style.cursor=this._isMouseOnRangeBorder()?"ew-resize":this._isMouseOnRange()?"grab":"default"}onClickAndMouseMove(t){const e=this._isMouseOutsideOfPage(t);this._actualizeMouseLocalPosition(t),this.prevRangeMoveMouseX&&(this.deltaRangeMoveMouseX=this.mouseX-this.prevRangeMoveMouseX,this._handleRangeMove(),e||(this.prevRangeMoveMouseX=this.mouseX)),this.prevLeftBorderMoveMouseX&&(this.deltaLeftBorderMoveMouseX=this.mouseX-this.prevLeftBorderMoveMouseX,this._handleRangeLeftBorderMove(),e||(this.prevLeftBorderMoveMouseX=this.mouseX)),this.prevRightBorderMoveMouseX&&(this.deltaRightBorderMoveMouseX=this.mouseX-this.prevRightBorderMoveMouseX,this._handleRangeRightBorderMove(),e||(this.prevRightBorderMoveMouseX=this.mouseX))}onMouseLeave(t){document.body.style.cursor="default"}onMouseUp(){document.removeEventListener("mousemove",this.clickAndMouseMoveHandler,!1),this.prevRangeMoveMouseX=null,this.prevLeftBorderMoveMouseX=null,this.prevRightBorderMoveMouseX=null}_handleRangeMove(){let t;document.body.style.cursor="grabbing";let e=!1;this.deltaRangeMoveMouseX>0?(t=this._getIncreasingDelta(this.deltaRangeMoveMouseX),e=!0):this.deltaRangeMoveMouseX<0&&(t=this._getDecreasingDelta(this.deltaRangeMoveMouseX),e=!0),e&&(this.rangeFromPx+=t,this.rangeToPx+=t,this._updateRange())}_handleRangeLeftBorderMove(){let t;this.deltaLeftBorderMoveMouseX>0?(t=Math.min(this.deltaLeftBorderMoveMouseX,this.rangeToPx-this.minVisibleRangeDelta-this.rangeFromPx),this.rangeFromPx+=t,this._updateRange()):this.deltaLeftBorderMoveMouseX<0&&(t=this._getDecreasingDelta(this.deltaLeftBorderMoveMouseX),this.rangeFromPx+=t,this._updateRange())}_handleRangeRightBorderMove(){let t;this.deltaRightBorderMoveMouseX>0?(t=this._getIncreasingDelta(this.deltaRightBorderMoveMouseX),this.rangeToPx+=t,this._updateRange()):this.deltaRightBorderMoveMouseX<0&&(t=Math.max(this.deltaRightBorderMoveMouseX,-(this.rangeToPx-this.rangeFromPx-this.minVisibleRangeDelta)),this.rangeToPx+=t,this._updateRange())}_updateRange(){const t=this._convertRangePxToPercents(this.rangeFromPx),e=this._convertRangePxToPercents(this.rangeToPx);p(this.index,t,e)}_isMouseOnRange(){return this.mouseX.between(this.rangeFromPx,this.rangeToPx)&&this._isMouseYInsideLayout()}_isMouseOnRangeBorder(){return this._isMouseOnLeftRangeBorder()||this._isMouseOnRightRangeBorder()}_isMouseOnLeftRangeBorder(){return this.mouseX.between(this.rangeFromPx-this.mouseBorderWidthHalf,this.rangeFromPx+this.mouseBorderWidthHalf)&&this._isMouseYInsideLayout()}_isMouseOnRightRangeBorder(){return this.mouseX.between(this.rangeToPx-this.mouseBorderWidthHalf,this.rangeToPx+this.mouseBorderWidthHalf)&&this._isMouseYInsideLayout()}_isMouseOutsideOfPage(t){return t.clientY<=0||t.clientX<=0||t.clientX>=window.innerWidth||t.clientY>=window.innerHeight}_isMouseYInsideLayout(){const t=this.ctx.canvas.getBoundingClientRect();return this.mouseY.between(s.layout.navigation.offsetTop,t.height)}_getIncreasingDelta(t){return Math.min(s.layout.navigation.width-this.rangeToPx,t)}_getDecreasingDelta(t){return Math.max(-this.rangeFromPx,t)}_convertRangePercentsToPx(t){return t*s.layout.navigation.width}_convertRangePxToPercents(t){return t/s.layout.navigation.width}_actualizeMouseLocalPosition(t){const e=this.ctx.canvas.getBoundingClientRect();this.mouseX=Math.round(t.clientX-e.left),this.mouseY=Math.round(t.clientY-e.top)}draw(){this.drawHandler(),this.charts.forEach(t=>t.draw(this.ctx)),this.drawCover()}drawHandler(){this.drawHandlerTopBottom(s.layout.navigation.offsetTop),this.drawHandlerTopBottom(s.layout.navigation.offsetTop+s.layout.navigation.height-3),this.drawHandlerSide(this.rangeFromPx),this.drawHandlerSide(this.rangeFromPx),this.drawHandlerSide(this.rangeToPx-5)}drawHandlerTopBottom(t){this.ctx.save(),this.ctx.fillStyle=s.colors.navigationHandler,this.ctx.fillRect(this.rangeFromPx,t,this.rangeToPx-this.rangeFromPx,3),this.ctx.restore()}drawHandlerSide(t){this.ctx.save(),this.ctx.fillStyle=s.colors.navigationHandler,this.ctx.fillRect(t,s.layout.navigation.offsetTop,5,s.layout.navigation.height),this.ctx.restore()}drawCover(){const t=s.layout.navigation.width,e=s.layout.navigation.offsetLeft;this.drawCoverPart(e,this.rangeFromPx),this.drawCoverPart(e+this.rangeToPx,t-this.rangeToPx)}drawCoverPart(t,e){this.ctx.save(),this.ctx.fillStyle=s.colors.navigationCover,this.ctx.fillRect(t,s.layout.navigation.offsetTop,e,s.layout.navigation.height),this.ctx.restore()}toggleChart(t){this.chartsFactory.toggleChart(t)}};Number.prototype.between=function(t,e,i){const s=Math.min(t,e),o=Math.max(t,e);return i?this>=s&&this<=o:this>s&&this<o},Array.prototype.findClosestValue=function(t){const e=this.map(e=>Math.abs(e-t)),i=Math.min.apply(Math,e);return this[e.indexOf(i)]};class y{constructor(t){this._init(t),this._bindEvents(),this._draw()}_init(t){const e=new l(t),i=e.getBaseName(),s=e.getNames(),o=e.getColors(),a=e.getChartsAmount(),n=this._createNavButtons(t,i);this._createChartTitle(i);const r=this._createCanvas(),h=this._createChartButtons(s,o,a);this.ctx=r,this.main=new m(r,t),this.navigation=new x(r,t),this.chartButtons=h,this.navButton=n}_createNavButtons(t,e){const i=document.createElement("button");return i.innerHTML=e,document.getElementById("navigation").appendChild(i),i}_createCanvas(){const t=document.createElement("canvas"),{offsetTop:e,offsetLeft:i}=s.layout.canvas,o=Math.min(s.layout.canvas.size,document.getElementById("charts").offsetWidth),a=2*o;t.width=a,t.height=a,t.style.width=o+"px",t.style.height=o+"px",t.style.top=e+"px",t.style.left=i+"px";const n=t.getContext("2d");return n.scale(2,2),document.getElementById("charts").appendChild(t),n}_createChartTitle(t){const e=document.createElement("h1");e.innerHTML=t,document.getElementById("charts").appendChild(e)}_createChartButtons(t,e,i){const s=[],o=document.createElement("div");o.className="chart-buttons",document.getElementById("charts").appendChild(o);for(let a=0;a<i;a++){const i=t[a],n=e[a],r=document.createElement("button");r.className="chart-buttons__button active";const h=document.createElement("span");h.className="chart-buttons__button__checkbox",h.style.backgroundColor=n,r.appendChild(h);const l=document.createElement("span");l.innerHTML=i,r.appendChild(l),o.appendChild(r),r.addEventListener("click",()=>r.classList.toggle("active"),!1),s.push(r)}return s}_clear(){this.ctx.clearRect(0,0,this.ctx.canvas.offsetWidth,this.ctx.canvas.offsetHeight)}_bindEvents(){this.chartButtons.forEach((t,e)=>{t.addEventListener("click",()=>this._toggleChart(e),!1)}),this.navButton.addEventListener("click",()=>this._scrollToChart(),!1)}_draw(){this._clear(),this.main.draw(),this.navigation.draw(),window.requestAnimationFrame(()=>this._draw())}_toggleChart(t){this.main.toggleChart(t),this.navigation.toggleChart(t)}_scrollToChart(){this.ctx.canvas.scrollIntoView({behavior:"smooth"})}}window.DATA.forEach((t,e)=>{t.index=e,new y(t)})}]);